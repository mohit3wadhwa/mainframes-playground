IDENTIFICATION DIVISION.
PROGRAM-ID. IMSINSRT.
ENVIRONMENT DIVISION.
DATA DIVISION.
WORKING-STORAGE SECTION.
01  WS-STATUS-CODE      PIC X(2).
01  DLI-GU              PIC X(4) VALUE 'GU '.
01  DLI-ISRT            PIC X(4) VALUE 'ISRT'.
01  SSA-ROOT            PIC X(32)
                         VALUE 'ROOTSEG(KEY-FLD = 0000000001)'.
01  SEGMENT-AREA.
    05 SEG-KEY          PIC X(10).
    05 SEG-DATA         PIC X(40).

LINKAGE SECTION.
01  IO-PCB              PIC X(80).
01  DB-PCB              PIC X(80).

PROCEDURE DIVISION USING IO-PCB DB-PCB.
MAIN-SECTION.
    MOVE ' ' TO SEGMENT-AREA.

*   POSITION ON PARENT / ROOT WITH GU
    CALL 'CBLTDLI' USING DLI-GU
                         DB-PCB
                         SEGMENT-AREA
                         SSA-ROOT.

*   IN REAL CODE, MOVE STATUS FROM PCB MASK; HERE ASSUME BLANK = OK
*   POPULATE CHILD SEGMENT TO INSERT
    MOVE '0000000001' TO SEG-KEY.
    MOVE 'NEW CHILD SEGMENT DATA' TO SEG-DATA.

*   INSERT NEW SEGMENT UNDER CURRENT PARENT
    CALL 'CBLTDLI' USING DLI-ISRT
                         DB-PCB
                         SEGMENT-AREA.

*   SIMPLE DISPLAY ONLY â€“ REAL CODE SHOULD CHECK PCB STATUS
    DISPLAY 'ATTEMPTED ISRT FOR KEY : ' SEG-KEY.
    DISPLAY 'DATA INSERTED (IF OK): ' SEG-DATA.

    GOBACK.
